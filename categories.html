<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Kategori Y√∂netimi</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="css/style.css">
	
	<style>
		* { box-sizing: border-box; }
		body {
			margin: 0;
			padding: 0;
			font-family: "Montserrat", Arial, sans-serif;
			background: linear-gradient(135deg, #3b82f6 0%, #2563eb 25%, #1d4ed8 50%, #1e40af 75%, #1e3a8a 100%);
			background-size: 400% 400%;
			animation: gradientShift 15s ease infinite, fadeIn 0.4s ease-in;
			min-height: 100vh;
		}
		
		@keyframes gradientShift {
			0% { background-position: 0% 50%; }
			50% { background-position: 100% 50%; }
			100% { background-position: 0% 50%; }
		}
		
		@keyframes fadeIn {
			from {
				opacity: 0;
				transform: translateY(20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}
		
		/* Ge√ßi≈ü Overlay */
		.page-transition-overlay {
			position: fixed !important;
			top: 0 !important;
			left: 0 !important;
			right: 0 !important;
			bottom: 0 !important;
			width: 100vw !important;
			height: 100vh !important;
			background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
			z-index: 99999 !important;
			opacity: 0;
			pointer-events: none;
			transition: opacity 0.3s ease-out;
			display: flex !important;
			align-items: center !important;
			justify-content: center !important;
			margin: 0 !important;
			padding: 0 !important;
		}
		
		.page-transition-overlay.hide {
			opacity: 0;
			pointer-events: none;
		}
		
		.page-transition-overlay.show {
			opacity: 1;
			pointer-events: all;
		}
		
		.page-transition-overlay .spinner {
			width: 60px;
			height: 60px;
			border: 4px solid rgba(255, 255, 255, 0.3);
			border-top-color: #fff;
			border-radius: 50%;
			animation: spin 0.8s linear infinite;
			margin: 0 auto;
			flex-shrink: 0;
		}
		
		@keyframes spin {
			to { transform: rotate(360deg); }
		}
		
		.category-header {
			background: rgba(255, 255, 255, 0.15);
			backdrop-filter: blur(20px);
			-webkit-backdrop-filter: blur(20px);
			color: #fff;
			padding: 24px 32px;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1),
			            0 0 0 1px rgba(255, 255, 255, 0.2) inset;
			border-bottom: 2px solid rgba(255, 255, 255, 0.1);
			position: sticky;
			top: 0;
			z-index: 100;
			position: relative;
			overflow: hidden;
		}
		
		.category-header::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
			animation: shimmer 3s infinite;
		}
		
		@keyframes shimmer {
			0% { left: -100%; }
			100% { left: 100%; }
		}
		
		.category-header-content {
			max-width: 1400px;
			margin: 0 auto;
			display: flex;
			justify-content: space-between;
			align-items: center;
			flex-wrap: wrap;
			gap: 20px;
			position: relative;
			z-index: 1;
		}
		
		.category-header h1 {
			margin: 0;
			font-size: 32px;
			font-weight: 700;
			display: flex;
			align-items: center;
			gap: 14px;
			background: linear-gradient(135deg, #fff 0%, rgba(255, 255, 255, 0.8) 100%);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			text-shadow: 0 2px 10px rgba(255, 255, 255, 0.3);
			letter-spacing: -0.5px;
		}
		
		.btn-back {
			background: rgba(255, 255, 255, 0.2);
			color: #fff;
			padding: 12px 24px;
			border: 1.5px solid rgba(255, 255, 255, 0.3);
			border-radius: 12px;
			text-decoration: none;
			font-size: 14px;
			font-weight: 600;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			display: inline-flex;
			align-items: center;
			gap: 8px;
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
			position: relative;
			overflow: hidden;
		}
		
		.btn-back::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
			transition: left 0.5s ease;
		}
		
		.btn-back:hover::before {
			left: 100%;
		}
		
		.btn-back:hover {
			background: rgba(255, 255, 255, 0.3);
			transform: translateY(-2px) scale(1.02);
			box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15),
			            inset 0 1px 0 rgba(255, 255, 255, 0.3);
			border-color: rgba(255, 255, 255, 0.5);
		}
		
		.category-container {
			max-width: 1400px;
			margin: 0 auto;
			padding: 30px 20px;
		}
		
		.btn-admin {
			background: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);
			color: #fff;
			padding: 12px 30px;
			border: none;
			border-radius: 12px;
			font-size: 16px;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			box-shadow: 0 8px 24px rgba(6, 182, 212, 0.35),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
			position: relative;
			overflow: hidden;
		}
		
		.btn-admin::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
			transition: left 0.5s ease;
		}
		
		.btn-admin:hover::before {
			left: 100%;
		}
		
		.btn-admin:hover {
			transform: translateY(-2px) scale(1.02);
			box-shadow: 0 12px 32px rgba(6, 182, 212, 0.45),
			            inset 0 1px 0 rgba(255, 255, 255, 0.3);
		}
		
		.btn-admin:active {
			transform: translateY(0) scale(0.98);
		}
		
		.category-card {
			background: rgba(255, 255, 255, 0.15);
			backdrop-filter: blur(20px);
			-webkit-backdrop-filter: blur(20px);
			border-radius: 20px;
			padding: 30px;
			margin-bottom: 30px;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1),
			            0 0 0 1px rgba(255, 255, 255, 0.2) inset;
			border: 1.5px solid rgba(255, 255, 255, 0.2);
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}
		
		.category-card:hover {
			transform: translateY(-4px);
			box-shadow: 0 16px 48px rgba(0, 0, 0, 0.15),
			            0 0 0 1px rgba(255, 255, 255, 0.3) inset;
			border-color: rgba(255, 255, 255, 0.4);
		}
		
		.category-list {
			display: grid;
			gap: 15px;
			margin-top: 20px;
		}
		
		.category-item {
			background: rgba(255, 255, 255, 0.2);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border: 1.5px solid rgba(255, 255, 255, 0.2);
			border-radius: 12px;
			padding: 20px;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08),
			            inset 0 1px 0 rgba(255, 255, 255, 0.1);
		}
		
		.category-item:hover {
			border-color: rgba(6, 182, 212, 0.4);
			box-shadow: 0 8px 24px rgba(6, 182, 212, 0.2),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
			transform: translateY(-2px);
			background: rgba(255, 255, 255, 0.25);
		}
		
		.category-item h3 {
			margin: 0 0 10px 0;
			font-size: 18px;
			color: #fff;
			text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
		}
		
		.category-item p {
			margin: 5px 0;
			font-size: 14px;
			color: rgba(255, 255, 255, 0.9);
		}
		
		/* Modern Popup Modal */
		.popup-modal-overlay {
			position: fixed !important;
			top: 0 !important;
			left: 0 !important;
			right: 0 !important;
			bottom: 0 !important;
			background: rgba(0, 0, 0, 0.6);
			backdrop-filter: blur(8px);
			-webkit-backdrop-filter: blur(8px);
			z-index: 99999 !important;
			display: none;
			align-items: center;
			justify-content: center;
			padding: 20px;
			animation: fadeIn 0.2s ease-out;
		}
		
		.popup-modal-overlay.show {
			display: flex;
		}
		
		@keyframes fadeIn {
			from { opacity: 0; }
			to { opacity: 1; }
		}
		
		.popup-modal {
			background: rgba(255, 255, 255, 0.15);
			backdrop-filter: blur(24px);
			-webkit-backdrop-filter: blur(24px);
			border-radius: 24px;
			width: 100%;
			max-width: 450px;
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3),
			            0 0 0 1px rgba(255, 255, 255, 0.2) inset;
			border: 1.5px solid rgba(255, 255, 255, 0.2);
			overflow: hidden;
			animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			transform-origin: center;
			position: relative;
			margin: auto;
		}
		
		@keyframes slideUp {
			from {
				transform: translateY(30px) scale(0.95);
				opacity: 0;
			}
			to {
				transform: translateY(0) scale(1);
				opacity: 1;
			}
		}
		
		.popup-modal-header {
			padding: 24px 30px 20px;
			background: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);
			color: #fff;
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 15px;
			position: relative;
			overflow: hidden;
		}
		
		.popup-modal-header::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			height: 2px;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
		}
		
		.popup-modal-header h3 {
			margin: 0;
			font-size: 20px;
			font-weight: 700;
			display: flex;
			align-items: center;
			gap: 10px;
			text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
		}
		
		.popup-modal-header .popup-icon {
			font-size: 24px;
			width: 36px;
			height: 36px;
			display: flex;
			align-items: center;
			justify-content: center;
			background: rgba(255, 255, 255, 0.2);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border-radius: 10px;
			border: 1px solid rgba(255, 255, 255, 0.3);
		}
		
		.popup-modal-body {
			padding: 30px;
			color: #fff;
			font-size: 15px;
			line-height: 1.6;
			background: rgba(255, 255, 255, 0.1);
		}
		
		.popup-modal-body p {
			margin: 0 0 15px 0;
			color: #fff;
		}
		
		.popup-modal-body strong {
			color: rgba(255, 255, 255, 0.9);
			font-weight: 600;
		}
		
		.popup-modal-footer {
			padding: 20px 30px;
			background: rgba(255, 255, 255, 0.1);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			display: flex;
			justify-content: flex-end;
			gap: 12px;
			border-top: 1px solid rgba(255, 255, 255, 0.2);
		}
		
		.popup-btn {
			padding: 12px 24px;
			border: none;
			border-radius: 12px;
			font-size: 15px;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			min-width: 100px;
			display: inline-flex;
			align-items: center;
			justify-content: center;
			gap: 8px;
			position: relative;
			overflow: hidden;
		}
		
		.popup-btn::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
			transition: left 0.5s ease;
		}
		
		.popup-btn:hover::before {
			left: 100%;
		}
		
		.popup-btn-primary {
			background: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);
			color: #fff;
			box-shadow: 0 8px 24px rgba(6, 182, 212, 0.35),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
		}
		
		.popup-btn-primary:hover {
			transform: translateY(-2px) scale(1.02);
			box-shadow: 0 12px 32px rgba(6, 182, 212, 0.45),
			            inset 0 1px 0 rgba(255, 255, 255, 0.3);
		}
		
		.popup-btn-secondary {
			background: rgba(255, 255, 255, 0.2);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			color: #fff;
			border: 1.5px solid rgba(255, 255, 255, 0.3);
			box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
		}
		
		.popup-btn-secondary:hover {
			background: rgba(255, 255, 255, 0.3);
			border-color: rgba(255, 255, 255, 0.5);
			transform: translateY(-2px) scale(1.02);
		}
		
		.popup-btn-danger {
			background: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
			color: #fff;
			box-shadow: 0 8px 24px rgba(239, 68, 68, 0.35),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
		}
		
		.popup-btn-danger:hover {
			transform: translateY(-2px) scale(1.02);
			box-shadow: 0 12px 32px rgba(239, 68, 68, 0.45),
			            inset 0 1px 0 rgba(255, 255, 255, 0.3);
		}
		
		.popup-btn-success {
			background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
			color: #fff;
			box-shadow: 0 8px 24px rgba(16, 185, 129, 0.35),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
		}
		
		.popup-btn-success:hover {
			transform: translateY(-2px) scale(1.02);
			box-shadow: 0 12px 32px rgba(16, 185, 129, 0.45),
			            inset 0 1px 0 rgba(255, 255, 255, 0.3);
		}
		
		/* Image Upload Container */
		.image-upload-container {
			display: flex;
			flex-direction: column;
			gap: 15px;
			padding: 20px;
			background: rgba(255, 255, 255, 0.1);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border-radius: 16px;
			border: 1.5px solid rgba(255, 255, 255, 0.2);
			box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08),
			            inset 0 1px 0 rgba(255, 255, 255, 0.1);
		}
		
		.upload-buttons-row {
			display: flex;
			gap: 12px;
			align-items: center;
			flex-wrap: wrap;
		}
		
		.btn-upload, .btn-url-add {
			white-space: nowrap;
			padding: 12px 24px;
			background: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);
			color: #fff;
			border: none;
			border-radius: 12px;
			font-size: 14px;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			box-shadow: 0 4px 16px rgba(6, 182, 212, 0.3),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
			position: relative;
			overflow: hidden;
		}
		
		.btn-upload::before, .btn-url-add::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
			transition: left 0.5s ease;
		}
		
		.btn-upload:hover::before, .btn-url-add:hover::before {
			left: 100%;
		}
		
		.btn-upload:hover, .btn-url-add:hover {
			transform: translateY(-2px) scale(1.02);
			box-shadow: 0 8px 24px rgba(6, 182, 212, 0.4),
			            inset 0 1px 0 rgba(255, 255, 255, 0.3);
		}
		
		.url-input {
			width: 100%;
			padding: 14px 18px;
			border: 2px solid rgba(255, 255, 255, 0.2);
			border-radius: 12px;
			font-size: 14px;
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}
		
		.url-input:focus {
			outline: none;
			border-color: #06b6d4;
			box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.1),
			           0 4px 16px rgba(6, 182, 212, 0.15);
			background: rgba(255, 255, 255, 1);
		}
		
		@media (max-width: 768px) {
			.category-header {
				padding: 16px 20px;
			}
			.category-header h1 { 
				font-size: 22px; 
			}
			.category-container { 
				padding: 20px 15px; 
			}
			.btn-back {
				padding: 10px 16px;
				font-size: 13px;
			}
			
			.popup-modal {
				max-width: 90%;
				margin: 20px;
			}
			
			.popup-modal-header {
				padding: 20px 24px 16px;
			}
			
			.popup-modal-header h3 {
				font-size: 18px;
			}
			
			.popup-modal-body {
				padding: 24px;
				font-size: 14px;
			}
			
			.popup-modal-footer {
				padding: 16px 24px;
				flex-direction: column-reverse;
			}
			
			.popup-btn {
				width: 100%;
			}
			
			/* Mobil i√ßin URL input ve butonlar */
			.image-upload-container {
				gap: 12px;
			}
			
			.upload-buttons-row {
				flex-direction: column;
				width: 100%;
				gap: 10px;
			}
			
			.btn-upload, .btn-url-add {
				width: 100%;
				padding: 14px 20px;
				font-size: 14px;
			}
			
			.url-input {
				width: 100%;
				padding: 14px 16px;
				font-size: 16px; /* iOS zoom √∂nleme i√ßin */
			}
		}
		
		/* Modal Stilleri */
		.admin-modal-overlay {
			position: fixed;
			inset: 0;
			background: rgba(0, 0, 0, 0.6);
			backdrop-filter: blur(8px);
			-webkit-backdrop-filter: blur(8px);
			z-index: 10000;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 20px;
			overflow-y: auto;
			overflow-x: hidden;
			animation: fadeIn 0.2s ease-out;
		}
		
		.admin-modal {
			background: rgba(255, 255, 255, 0.15);
			backdrop-filter: blur(24px);
			-webkit-backdrop-filter: blur(24px);
			border-radius: 24px;
			width: 100%;
			max-width: 900px;
			max-height: 90vh;
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3),
			            0 0 0 1px rgba(255, 255, 255, 0.2) inset;
			border: 1.5px solid rgba(255, 255, 255, 0.2);
			display: flex;
			flex-direction: column;
			overflow: hidden;
			overflow-x: hidden;
			animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}
		
		.admin-modal-header {
			padding: 24px 30px;
			border-bottom: 1px solid rgba(255, 255, 255, 0.2);
			display: flex;
			justify-content: space-between;
			align-items: center;
			background: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);
			color: #fff;
			position: relative;
			overflow: hidden;
		}
		
		.admin-modal-header::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			height: 2px;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
		}
		
		.admin-modal-header h2 {
			margin: 0;
			font-size: 24px;
			color: #fff;
			font-weight: 700;
			text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
		}
		
		.admin-modal-close {
			background: rgba(255, 255, 255, 0.2);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border: 1px solid rgba(255, 255, 255, 0.3);
			color: #fff;
			font-size: 28px;
			width: 44px;
			height: 44px;
			border-radius: 50%;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			line-height: 1;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		}
		
		.admin-modal-close:hover {
			background: rgba(255, 255, 255, 0.3);
			transform: scale(1.1) rotate(90deg);
			box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
		}
		
		.admin-modal-body {
			padding: 30px;
			overflow-y: auto;
			overflow-x: hidden;
			flex: 1;
			background: rgba(255, 255, 255, 0.1);
			box-sizing: border-box;
		}
		
		@media (max-width: 768px) {
			.admin-modal-body {
				padding: 20px;
			}
		}
		
		@media (max-width: 480px) {
			.admin-modal-body {
				padding: 16px;
			}
		}
		
		.admin-form-group {
			margin-bottom: 20px;
		}
		
		.admin-form-group label {
			display: block;
			margin-bottom: 8px;
			font-weight: 600;
			color: #fff;
			font-size: 14px;
			text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
		}
		
		.admin-form-group input,
		.admin-form-group textarea,
		.admin-form-group select {
			width: 100%;
			padding: 14px 18px;
			border: 2px solid rgba(255, 255, 255, 0.2);
			border-radius: 12px;
			font-size: 14px;
			font-family: "Montserrat", Arial, sans-serif;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			color: #1a1a1a;
		}
		
		.admin-form-group select {
			cursor: pointer;
			background-color: rgba(255, 255, 255, 0.95);
		}
		
		.admin-form-group input:focus,
		.admin-form-group textarea:focus,
		.admin-form-group select:focus {
			outline: none;
			border-color: #06b6d4;
			box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.1),
			           0 4px 16px rgba(6, 182, 212, 0.15);
			background: rgba(255, 255, 255, 1);
		}
		
		.admin-form-group input::placeholder,
		.admin-form-group textarea::placeholder {
			color: rgba(107, 114, 128, 0.6);
		}
		
		.admin-form-group textarea {
			min-height: 100px;
			resize: vertical;
		}
		
		.btn-admin-secondary {
			background: linear-gradient(135deg, #6b7280 0%, #4b5563 50%, #374151 100%);
			box-shadow: 0 8px 24px rgba(107, 114, 128, 0.35),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
		}
		
		.btn-admin-secondary:hover {
			box-shadow: 0 12px 32px rgba(107, 114, 128, 0.45),
			            inset 0 1px 0 rgba(255, 255, 255, 0.3);
		}
		
		.lang-tabs {
			display: flex;
			flex-wrap: wrap;
			gap: 8px;
			margin-bottom: 20px;
		}
		
		.lang-tab {
			padding: 10px 24px;
			background: rgba(255, 255, 255, 0.2);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border: 1.5px solid rgba(255, 255, 255, 0.2);
			border-radius: 10px;
			cursor: pointer;
			font-weight: 600;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			color: #fff;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08),
			            inset 0 1px 0 rgba(255, 255, 255, 0.1);
			white-space: nowrap;
			flex: 1 1 auto;
			min-width: 0;
		}
		
		@media (max-width: 768px) {
			.lang-tabs {
				gap: 6px;
				margin-bottom: 16px;
			}
			
			.lang-tab {
				padding: 8px 16px;
				font-size: 13px;
				flex: 1 1 calc(50% - 3px);
				min-width: calc(50% - 3px);
			}
		}
		
		@media (max-width: 480px) {
			.lang-tabs {
				gap: 6px;
				margin-bottom: 14px;
			}
			
			.lang-tab {
				padding: 8px 12px;
				font-size: 12px;
				flex: 1 1 calc(50% - 3px);
				min-width: calc(50% - 3px);
			}
		}
		
		.lang-tab:hover {
			background: rgba(255, 255, 255, 0.3);
			border-color: rgba(255, 255, 255, 0.4);
			transform: translateY(-2px);
		}
		
		.lang-tab.active {
			background: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);
			color: #fff;
			border-color: rgba(255, 255, 255, 0.3);
			box-shadow: 0 8px 24px rgba(6, 182, 212, 0.35),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
		}
		
		.lang-content {
			display: none;
		}
		
		.lang-content.active {
			display: block;
		}
		
		.category-item {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 20px;
			background: rgba(255, 255, 255, 0.2);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border: 1.5px solid rgba(255, 255, 255, 0.2);
			border-radius: 12px;
			margin-bottom: 10px;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08),
			            inset 0 1px 0 rgba(255, 255, 255, 0.1);
		}
		
		.category-item:hover {
			border-color: rgba(6, 182, 212, 0.4);
			box-shadow: 0 8px 24px rgba(6, 182, 212, 0.2),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
			transform: translateY(-2px);
			background: rgba(255, 255, 255, 0.25);
		}
		
		.category-item-actions {
			display: flex;
			gap: 10px;
		}
		
		.btn-edit {
			background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
			color: #fff;
			padding: 10px 20px;
			border: none;
			border-radius: 10px;
			cursor: pointer;
			font-size: 14px;
			font-weight: 600;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			box-shadow: 0 4px 16px rgba(16, 185, 129, 0.3),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
			position: relative;
			overflow: hidden;
		}
		
		.btn-edit::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
			transition: left 0.5s ease;
		}
		
		.btn-edit:hover::before {
			left: 100%;
		}
		
		.btn-edit:hover {
			transform: translateY(-2px) scale(1.05);
			box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4),
			            inset 0 1px 0 rgba(255, 255, 255, 0.3);
		}
		
		.btn-delete {
			background: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
			color: #fff;
			padding: 10px 20px;
			border: none;
			border-radius: 10px;
			cursor: pointer;
			font-size: 14px;
			font-weight: 600;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			box-shadow: 0 4px 16px rgba(239, 68, 68, 0.3),
			            inset 0 1px 0 rgba(255, 255, 255, 0.2);
			position: relative;
			overflow: hidden;
		}
		
		.btn-delete::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
			transition: left 0.5s ease;
		}
		
		.btn-delete:hover::before {
			left: 100%;
		}
		
		.btn-delete:hover {
			transform: translateY(-2px) scale(1.05);
			box-shadow: 0 8px 24px rgba(239, 68, 68, 0.4),
			            inset 0 1px 0 rgba(255, 255, 255, 0.3);
		}
	</style>
</head>
<body>
	<!-- ≈ûifre Giri≈ü Ekranƒ± -->
	<div id="loginScreen" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 25%, #1d4ed8 50%, #1e40af 75%, #1e3a8a 100%); background-size: 400% 400%; animation: gradientShift 15s ease infinite; z-index: 10000; display: flex; align-items: center; justify-content: center; padding: 20px;">
		<div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px); padding: 50px 40px; border-radius: 24px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.2) inset; max-width: 450px; width: 100%; border: 1.5px solid rgba(255, 255, 255, 0.2); position: relative; overflow: hidden;">
			<div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #3b82f6, #2563eb, #1d4ed8);"></div>
			<h2 style="margin: 0 0 30px 0; text-align: center; color: #fff; font-size: 28px; font-weight: 700; text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);">üîí Kategori Y√∂netimi</h2>
			<div class="alert alert-error" id="loginError" style="display: none; margin-bottom: 20px; padding: 15px 20px; border-radius: 12px; background: rgba(254, 226, 226, 0.9); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); color: #991b1b; border: 1.5px solid rgba(239, 68, 68, 0.3); box-shadow: 0 4px 16px rgba(239, 68, 68, 0.15);"></div>
			<div style="margin-bottom:20px;">
				<label style="display: block; margin-bottom: 10px; font-weight: 600; color: rgba(255, 255, 255, 0.95); font-size: 14px;">≈ûifre</label>
				<input type="password" id="adminPassword" placeholder="Admin ≈üifresini gir..." style="width: 100%; padding: 14px 18px; border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 12px; font-size: 16px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); outline: none; transition: all 0.3s;">
			</div>
			<style>
				#adminPassword:focus {
					border-color: #06b6d4 !important;
					box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.1), 0 4px 16px rgba(6, 182, 212, 0.15) !important;
					background: rgba(255, 255, 255, 1) !important;
				}
			
			/* Category Dropdown Styles - Language dropdown gibi */
			.category-dropdown {
				position: relative;
				width: 100%;
			}
			
			.category-dropdown-trigger {
				display: inline-flex;
				align-items: center;
				justify-content: space-between;
				width: 100%;
				gap: 7px;
				border: none;
				border-radius: 999px;
				padding: 8px 12px 8px 14px;
				background: rgba(248, 250, 255, 0.8);
				color: #1f2937;
				font-size: 13px;
				font-weight: 600;
				cursor: pointer;
				box-shadow: 0 2px 12px rgba(124, 93, 255, 0.08),
				            inset 0 1px 0 rgba(255, 255, 255, 0.9);
				border: 1.5px solid rgba(124, 93, 255, 0.15);
				transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
				position: relative;
				overflow: hidden;
			}
			
			.category-dropdown-trigger::before {
				content: '';
				position: absolute;
				top: 0;
				left: -100%;
				width: 100%;
				height: 100%;
				background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
				transition: left 0.5s ease;
			}
			
			.category-dropdown-trigger:hover {
				background: rgba(255, 255, 255, 0.95);
				box-shadow: 0 4px 16px rgba(124, 93, 255, 0.12),
				            inset 0 1px 0 rgba(255, 255, 255, 1);
				border-color: rgba(124, 93, 255, 0.25);
				transform: translateY(-1px);
			}
			
			.category-dropdown-trigger:hover::before {
				left: 100%;
			}
			
			.category-dropdown-label {
				flex: 1;
				text-align: left;
			}
			
			.category-dropdown-arrow {
				font-size: 10px;
				opacity: 0.6;
				transition: transform 0.3s ease, opacity 0.3s ease;
				margin-left: 2px;
			}
			
			.category-dropdown-trigger:hover .category-dropdown-arrow {
				opacity: 1;
			}
			
			.category-dropdown-menu {
				position: absolute;
				top: calc(100% + 8px);
				bottom: auto;
				left: 0;
				right: 0;
				background: rgba(255, 255, 255, 0.98);
				backdrop-filter: blur(24px);
				-webkit-backdrop-filter: blur(24px);
				border-radius: 16px;
				border: 1.5px solid rgba(124, 93, 255, 0.15);
				box-shadow: 0 20px 40px rgba(124, 93, 255, 0.15),
				           0 0 0 1px rgba(255, 255, 255, 0.8) inset;
				display: none;
				flex-direction: column;
				min-width: 100%;
				max-height: 400px;
				overflow-y: auto;
				overflow-x: hidden;
				padding: 8px;
				z-index: 100002 !important;
			}
			
			.category-dropdown-menu.open-up {
				top: auto;
				bottom: calc(100% + 8px);
			}
			
			.category-dropdown-menu.open {
				display: flex;
				animation: dropdownFadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			}
			
			@keyframes dropdownFadeIn {
				from {
					opacity: 0;
					transform: translateY(-8px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}
			
			.category-dropdown-menu .category-item {
				padding: 10px 14px;
				text-align: left;
				display: inline-flex !important;
				align-items: center !important;
				gap: 8px;
				background: transparent !important;
				border: none !important;
				border-radius: 10px;
				color: #1f2937 !important;
				font-weight: 600 !important;
				font-size: 13px !important;
				letter-spacing: 0.2px;
				transition: all 0.2s ease;
				position: relative;
				cursor: pointer;
				width: 100%;
				justify-content: flex-start;
			}
			
			.category-dropdown-menu .category-item:hover {
				background: rgba(124, 93, 255, 0.08) !important;
				color: #7c5dff !important;
				transform: translateX(4px);
			}
			
			.category-dropdown-menu .category-item.active {
				background: linear-gradient(135deg, rgba(124, 93, 255, 0.15), rgba(100, 71, 255, 0.12)) !important;
				color: #7c5dff !important;
				font-weight: 700 !important;
			}
			
			.category-dropdown-menu .category-item.active::after {
				content: '‚úì';
				position: absolute;
				right: 12px;
				font-size: 12px;
				color: #7c5dff;
				font-weight: bold;
			}
		</style>
		<button onclick="checkPassword()" class="btn-admin" style="width: 100%; margin-top: 20px; padding: 16px 30px; font-size: 16px;">Giri≈ü Yap</button>
		</div>
	</div>

	<div id="pageContent" style="display: none;">
	<!-- Modern Popup Modal -->
	<div id="popupModal" class="popup-modal-overlay">
		<div class="popup-modal">
			<div class="popup-modal-header">
				<h3>
					<span class="popup-icon" id="popupIcon">‚Ñπ</span>
					<span id="popupTitle">Bilgi</span>
				</h3>
			</div>
			<div class="popup-modal-body">
				<p id="popupMessage"></p>
			</div>
			<div class="popup-modal-footer" id="popupFooter">
				<!-- Butonlar JavaScript ile eklenecek -->
			</div>
		</div>
	</div>
	
	<header class="category-header">
		<div class="category-header-content">
			<h1>üìÇ Kategori Y√∂netimi</h1>
			<div style="display: flex; gap: 10px;">
				<a href="admin.html" class="btn-back">‚Üê Admin Paneli</a>
			</div>
		</div>
	</header>
	
	<div class="category-container">
		<div class="category-card">
			<div style="display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 20px;">
				<button class="btn-admin" onclick="openMainCategoryModal()">‚ûï Ana Kategori Ekle</button>
				<button class="btn-admin" onclick="openSubCategoryModal()">‚ûï Alt Kategori Ekle</button>
				<button class="btn-admin" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);" onclick="saveCategoriesToServer()">üíæ Sunucuya Kaydet</button>
			</div>
			
			<h2 style="margin: 20px 0 15px 0; font-size: 20px; color: #fff; text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);">Mevcut Kategoriler</h2>
			<div id="categoriesList" class="category-list">
				<p style="color: rgba(255, 255, 255, 0.9); text-align: center; padding: 40px;">Kategoriler y√ºkleniyor...</p>
			</div>
		</div>
	</div>
	
	<!-- Ana Kategori Modal -->
	<div id="mainCategoryModal" class="admin-modal-overlay" style="display: none;">
		<div class="admin-modal" style="max-width: 700px; overflow-x: hidden;">
			<div class="admin-modal-header">
				<h2 id="mainCategoryModalTitle">Ana Kategori Ekle</h2>
				<button type="button" class="admin-modal-close" onclick="closeMainCategoryModal()">&times;</button>
			</div>
			<div class="admin-modal-body">
				<form id="mainCategoryForm">
					<input type="hidden" id="mainCategoryIndex" value="-1">
					<div class="lang-tabs">
						<button type="button" class="lang-tab active" onclick="switchLang('tr')">T√ºrk√ße</button>
						<button type="button" class="lang-tab" onclick="switchLang('en')">English</button>
						<button type="button" class="lang-tab" onclick="switchLang('ka')">·É•·Éê·É†·Éó·É£·Éö·Éò</button>
						<button type="button" class="lang-tab" onclick="switchLang('ru')">–†—É—Å—Å–∫–∏–π</button>
					</div>
					<div id="lang-tr" class="lang-content active">
						<div class="admin-form-group">
							<label>Kategori Adƒ± (TR)</label>
							<input type="text" id="mainTitleTr" required>
						</div>
						<div class="admin-form-group">
							<label>A√ßƒ±klama (TR)</label>
							<textarea id="mainDescriptionTr" rows="3"></textarea>
						</div>
					</div>
					<div id="lang-en" class="lang-content">
						<div class="admin-form-group">
							<label>Kategori Adƒ± (EN)</label>
							<input type="text" id="mainTitleEn">
						</div>
						<div class="admin-form-group">
							<label>A√ßƒ±klama (EN)</label>
							<textarea id="mainDescriptionEn" rows="3"></textarea>
						</div>
					</div>
					<div id="lang-ka" class="lang-content">
						<div class="admin-form-group">
							<label>Kategori Adƒ± (KA)</label>
							<input type="text" id="mainTitleKa">
						</div>
						<div class="admin-form-group">
							<label>A√ßƒ±klama (KA)</label>
							<textarea id="mainDescriptionKa" rows="3"></textarea>
						</div>
					</div>
					<div id="lang-ru" class="lang-content">
						<div class="admin-form-group">
							<label>Kategori Adƒ± (RU)</label>
							<input type="text" id="mainTitleRu">
						</div>
						<div class="admin-form-group">
							<label>A√ßƒ±klama (RU)</label>
							<textarea id="mainDescriptionRu" rows="3"></textarea>
						</div>
					</div>
					<div class="admin-form-group">
						<label>Kategori G√∂rseli (Header Image)</label>
						<div id="mainCategoryImagePreview" style="margin-bottom: 10px; display: none;">
							<img id="mainCategoryImagePreviewImg" src="" alt="Preview" style="max-width: 200px; max-height: 150px; border-radius: 8px; border: 2px solid #e5e7eb; object-fit: cover; display: block;">
						</div>
						<div class="image-upload-container">
							<input type="file" id="mainCategoryImageFile" accept="image/*" style="display: none;" onchange="uploadMainCategoryImage()">
							<div class="upload-buttons-row">
								<button type="button" id="uploadMainCategoryBtn" class="btn-admin btn-upload" onclick="document.getElementById('mainCategoryImageFile').click()">üìÅ Bilgisayardan Y√ºkle</button>
								<button type="button" class="btn-admin btn-url-add" onclick="addMainCategoryImageUrl()">+ URL Ekle</button>
							</div>
							<input type="text" id="mainCategoryImage" placeholder="Veya URL ekle" class="url-input">
						</div>
					</div>
					<div class="admin-form-group">
						<label>Slug (URL)</label>
						<input type="text" id="mainSlug" required>
						<small style="color: rgba(255, 255, 255, 0.8);">√ñrnek: temizlik-urunleri</small>
					</div>
					<div style="display: flex; gap: 10px; margin-top: 20px;">
						<button type="button" class="btn-admin" onclick="saveMainCategory()">Kaydet</button>
						<button type="button" class="btn-admin btn-admin-secondary" onclick="closeMainCategoryModal()">ƒ∞ptal</button>
					</div>
				</form>
			</div>
		</div>
	</div>
	
	<!-- Alt Kategori Modal -->
	<div id="subCategoryModal" class="admin-modal-overlay" style="display: none;">
		<div class="admin-modal" style="max-width: 700px; overflow-x: hidden;">
			<div class="admin-modal-header">
				<h2 id="subCategoryModalTitle">Alt Kategori Ekle</h2>
				<button type="button" class="admin-modal-close" onclick="closeSubCategoryModal()">&times;</button>
			</div>
			<div class="admin-modal-body">
				<form id="subCategoryForm">
					<input type="hidden" id="subCategoryIndex" value="-1">
					<div class="admin-form-group">
						<label>Ana Kategori</label>
						<div class="category-dropdown">
							<button type="button" class="category-dropdown-trigger" id="subMainCategoryTrigger" aria-haspopup="true" aria-expanded="false">
								<span class="category-dropdown-label">Se√ßiniz...</span>
								<span class="category-dropdown-arrow">‚ñæ</span>
							</button>
							<div class="category-dropdown-menu" id="subMainCategoryMenu" role="menu"></div>
							<input type="hidden" id="subMainCategoryId" required>
						</div>
					</div>
					<div class="lang-tabs">
						<button type="button" class="lang-tab active" onclick="switchLangSub('tr')">T√ºrk√ße</button>
						<button type="button" class="lang-tab" onclick="switchLangSub('en')">English</button>
						<button type="button" class="lang-tab" onclick="switchLangSub('ka')">·É•·Éê·É†·Éó·É£·Éö·Éò</button>
						<button type="button" class="lang-tab" onclick="switchLangSub('ru')">–†—É—Å—Å–∫–∏–π</button>
					</div>
					<div id="lang-sub-tr" class="lang-content active">
						<div class="admin-form-group">
							<label>Kategori Adƒ± (TR)</label>
							<input type="text" id="subTitleTr" required>
						</div>
					</div>
					<div id="lang-sub-en" class="lang-content">
						<div class="admin-form-group">
							<label>Kategori Adƒ± (EN)</label>
							<input type="text" id="subTitleEn">
						</div>
					</div>
					<div id="lang-sub-ka" class="lang-content">
						<div class="admin-form-group">
							<label>Kategori Adƒ± (KA)</label>
							<input type="text" id="subTitleKa">
						</div>
					</div>
					<div id="lang-sub-ru" class="lang-content">
						<div class="admin-form-group">
							<label>Kategori Adƒ± (RU)</label>
							<input type="text" id="subTitleRu">
						</div>
					</div>
					<div style="display: flex; gap: 10px; margin-top: 20px;">
						<button type="button" class="btn-admin" onclick="saveSubCategory()">Kaydet</button>
						<button type="button" class="btn-admin btn-admin-secondary" onclick="closeSubCategoryModal()">ƒ∞ptal</button>
					</div>
				</form>
			</div>
		</div>
	</div>
	
	<script src="js/jquery.min.js"></script>
	<script src="js/data-products.js"></script>
	<script>
		var categoriesData = { mainCategories: [], subCategories: [] };
		
		// Modern Popup Modal Fonksiyonlarƒ±
		var popupResolve = null;
		
		function showAlert(type, message) {
			return new Promise(function(resolve) {
				var $modal = $('#popupModal');
				var $icon = $('#popupIcon');
				var $title = $('#popupTitle');
				var $message = $('#popupMessage');
				var $footer = $('#popupFooter');
				
				var icon = '‚Ñπ', title = 'Bilgi';
				switch(type) {
					case 'success': icon = '‚úì'; title = 'Ba≈üarƒ±lƒ±'; break;
					case 'error': icon = '‚úï'; title = 'Hata'; break;
					case 'warning': icon = '‚ö†'; title = 'Uyarƒ±'; break;
				}
				
				$icon.text(icon);
				$title.text(title);
				$message.html((message || '').replace(/\n/g, '<br>'));
				$footer.html('<button class="popup-btn popup-btn-primary" onclick="closePopup()">Tamam</button>');
				
				popupResolve = resolve;
				$modal.addClass('show');
				$(document).off('keydown.popup').on('keydown.popup', function(e) {
					if (e.key === 'Enter' || e.key === 'Escape') closePopup();
				});
			});
		}
		
		function showConfirm(message, title) {
			if (!title) title = 'Onay';
			return new Promise(function(resolve) {
				var $modal = $('#popupModal');
				$('#popupIcon').text('‚ùì');
				$('#popupTitle').text(title);
				$('#popupMessage').html((message || '').replace(/\n/g, '<br>'));
				$('#popupFooter').html(
					'<button class="popup-btn popup-btn-secondary" onclick="closePopup(false)">ƒ∞ptal</button>' +
					'<button class="popup-btn popup-btn-primary" onclick="closePopup(true)">Tamam</button>'
				);
				popupResolve = resolve;
				$modal.addClass('show');
				$(document).off('keydown.popup').on('keydown.popup', function(e) {
					if (e.key === 'Enter') closePopup(true);
					else if (e.key === 'Escape') closePopup(false);
				});
			});
		}
		
		function closePopup(result) {
			$('#popupModal').removeClass('show');
			$(document).off('keydown.popup');
			if (popupResolve) {
				popupResolve(result !== false);
				popupResolve = null;
			}
		}
		
		$(document).on('click', '.popup-modal-overlay', function(e) {
			if (e.target === this) closePopup(false);
		});
		
		// Kategorileri y√ºkle
		function loadCategories() {
			// √ñnce backend'den y√ºkle (API)
			$.ajax({
				url: '/api/products',
				method: 'GET',
				success: function(response) {
					if (response && response.mainCategories && response.mainCategories.length > 0) {
						// Backend'den gelen veriyi kullan
						var mainCats = response.mainCategories;
						categoriesData.mainCategories = mainCats.map(function(mc, index) {
							return {
								id: 'main_' + (mc.slug || 'cat' + index),
								title: mc.title || { tr: '', en: '', ka: '', ru: '' },
								slug: mc.slug || '',
								description: mc.description || { tr: '', en: '', ka: '', ru: '' },
								headerImage: mc.headerImage || ''
							};
						});
						
						// Alt kategorileri de y√ºkle
						if (mainCats.length > 0) {
							categoriesData.subCategories = [];
							mainCats.forEach(function(mc) {
								if (mc.subCategories && mc.subCategories.length > 0) {
									mc.subCategories.forEach(function(sc) {
									categoriesData.subCategories.push({
										id: 'sub_' + Date.now() + '_' + Math.random(),
										mainCategoryId: 'main_' + mc.slug,
										title: sc.title || { tr: '', en: '', ka: '', ru: '' }
									});
									});
								}
							});
						}
						
						// Backend'den y√ºklendi, localStorage kullanƒ±mƒ± kaldƒ±rƒ±ldƒ±
						renderCategories();
						return;
					}
					
					// Backend'den veri yoksa, data-products.js'den y√ºkle
					if (typeof mainCategories !== 'undefined' && mainCategories.length > 0) {
						categoriesData.mainCategories = mainCategories.map(function(mc, index) {
							return {
								id: 'main_' + (mc.slug || 'cat' + index),
								title: mc.title || { tr: '', en: '', ka: '', ru: '' },
								slug: mc.slug || '',
								description: mc.description || { tr: '', en: '', ka: '', ru: '' },
								headerImage: mc.headerImage || ''
							};
						});
						renderCategories();
						return;
					}
					
					// Backend'den veri yoksa bo≈ü g√∂ster
					
					$('#categoriesList').html('<p style="color: rgba(255, 255, 255, 0.9); text-align: center; padding: 40px;">Hen√ºz kategori eklenmemi≈ü.</p>');
				},
				error: function() {
					// API hatasƒ± durumunda hata mesajƒ± g√∂ster
					$('#categoriesList').html('<p style="color: #ef4444; text-align: center; padding: 40px;">‚ö†Ô∏è Kategoriler y√ºklenemedi. Sunucu √ßalƒ±≈ümƒ±yor olabilir.</p>');
				}
			});
		}
		
		// Kategorileri listele
		function renderCategories() {
			var $list = $('#categoriesList');
			
			if (!categoriesData.mainCategories || categoriesData.mainCategories.length === 0) {
				$list.html('<p style="color: #6b7280; text-align: center; padding: 40px;">Hen√ºz kategori eklenmemi≈ü.</p>');
				return;
			}
			
			var html = '';
			categoriesData.mainCategories.forEach(function(cat) {
				var titleTr = cat.title.tr || '';
				var titleEn = cat.title.en || '';
				var slug = cat.slug || '';
				
				// Alt kategorileri say
				var subCatCount = 0;
				if (categoriesData.subCategories) {
					subCatCount = categoriesData.subCategories.filter(function(sc) {
						return sc.mainCategoryId === cat.id;
					}).length;
				}
				
				html += '<div class="category-item">';
				html += '<div style="flex: 1;">';
				var titleDisplay = titleTr || 'ƒ∞simsiz Kategori';
				html += '<h3 style="margin: 0 0 8px 0; font-size: 18px; color: #fff; text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);">' + escapeHtml(titleDisplay) + '</h3>';
				html += '<p style="margin: 4px 0; font-size: 14px; color: rgba(255, 255, 255, 0.9);"><strong>Slug:</strong> ' + escapeHtml(slug) + '</p>';
				html += '<p style="margin: 4px 0; font-size: 14px; color: rgba(255, 255, 255, 0.9);"><strong>Alt Kategoriler:</strong> ' + subCatCount + '</p>';
				
				// Alt kategorileri listele
				if (categoriesData.subCategories && subCatCount > 0) {
					html += '<div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255, 255, 255, 0.2);">';
					html += '<strong style="font-size: 13px; color: rgba(255, 255, 255, 0.9);">Alt Kategoriler:</strong>';
					html += '<div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">';
					categoriesData.subCategories.forEach(function(sc, subIndex) {
						if (sc.mainCategoryId === cat.id) {
							var subTitleTr = sc.title ? (sc.title.tr || '') : '';
							var subTitle = subTitleTr || 'ƒ∞simsiz Alt Kategori';
							var globalSubIndex = categoriesData.subCategories.indexOf(sc);
							html += '<div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); padding: 6px 12px; border-radius: 8px; display: flex; align-items: center; gap: 8px; font-size: 13px; border: 1px solid rgba(255, 255, 255, 0.2);">';
							html += '<span style="color: rgba(255, 255, 255, 0.9);">' + escapeHtml(subTitle) + '</span>';
							html += '<button class="btn-edit" style="padding: 4px 8px; font-size: 11px;" onclick="editSubCategory(' + globalSubIndex + ')">‚úèÔ∏è</button>';
							html += '<button class="btn-delete" style="padding: 4px 8px; font-size: 11px;" onclick="deleteSubCategory(' + globalSubIndex + ')">üóëÔ∏è</button>';
							html += '</div>';
						}
					});
					html += '</div>';
					html += '</div>';
				}
				
				html += '</div>';
				html += '<div class="category-item-actions">';
				html += '<button class="btn-edit" onclick="editMainCategory(' + categoriesData.mainCategories.indexOf(cat) + ')">‚úèÔ∏è D√ºzenle</button>';
				html += '<button class="btn-delete" onclick="deleteMainCategory(' + categoriesData.mainCategories.indexOf(cat) + ')">üóëÔ∏è Sil</button>';
				html += '</div>';
				html += '</div>';
			});
			
			$list.html(html);
		}
		
		// Ana kategori modal
		function openMainCategoryModal() {
			$('#mainCategoryIndex').val('-1');
			$('#mainCategoryModalTitle').text('Ana Kategori Ekle');
			$('#mainCategoryForm')[0].reset();
			$('#mainCategoryImagePreview').hide();
			$('#mainCategoryImageFile').val('');
			$('#mainCategoryImage').val('');
			$('#mainCategoryModal').css('display', 'flex');
			switchLang('tr');
		}
		
		function closeMainCategoryModal() {
			$('#mainCategoryModal').hide();
			$('#mainCategoryImagePreview').hide();
			$('#mainCategoryImageFile').val('');
			$('#mainCategoryImage').val('');
			$('#mainCategoryImagePreviewImg').attr('src', '');
		}
		
		function editMainCategory(index) {
			if (index < 0 || index >= categoriesData.mainCategories.length) return;
			
			var cat = categoriesData.mainCategories[index];
			$('#mainCategoryIndex').val(index);
			$('#mainCategoryModalTitle').text('Ana Kategoriyi D√ºzenle');
			
			$('#mainTitleTr').val(cat.title ? cat.title.tr || '' : '');
			$('#mainTitleEn').val(cat.title ? cat.title.en || '' : '');
			$('#mainTitleKa').val(cat.title ? cat.title.ka || '' : '');
			$('#mainTitleRu').val(cat.title ? cat.title.ru || '' : '');
			$('#mainDescriptionTr').val(cat.description ? cat.description.tr || '' : '');
			$('#mainDescriptionEn').val(cat.description ? cat.description.en || '' : '');
			$('#mainDescriptionKa').val(cat.description ? cat.description.ka || '' : '');
			$('#mainDescriptionRu').val(cat.description ? cat.description.ru || '' : '');
			$('#mainSlug').val(cat.slug || '');
			
			// Header image'i y√ºkle
			var headerImage = cat.headerImage || '';
			$('#mainCategoryImage').val(headerImage);
			
			// Preview g√∂ster
			var $previewImg = $('#mainCategoryImagePreviewImg');
			var $preview = $('#mainCategoryImagePreview');
			
			if (headerImage && headerImage.trim().length > 0) {
				var imageUrl = (typeof headerImage === 'string') ? headerImage.trim() : headerImage;
				$previewImg.attr('src', imageUrl).off('error load').on('error', function() {
					$preview.hide();
				}).on('load', function() {
					$preview.show();
				});
				
				// Eƒüer resim zaten y√ºklenmi≈üse (cache'den) direkt g√∂ster
				setTimeout(function() {
					if ($previewImg[0].complete && $previewImg[0].naturalWidth > 0) {
						$preview.show();
					} else if ($previewImg[0].complete) {
						$preview.hide();
					}
				}, 100);
			} else {
				$preview.hide();
			}
			$('#mainCategoryImageFile').val('');
			
			$('#mainCategoryModal').css('display', 'flex');
			switchLang('tr');
		}
		
		function deleteMainCategory(index) {
			if (index < 0 || index >= categoriesData.mainCategories.length) return;
			
			var cat = categoriesData.mainCategories[index];
			var title = cat.title ? (cat.title.tr || 'Kategori') : 'Kategori';
			
			// Bu kategoriye ait √ºr√ºn sayƒ±sƒ±nƒ± say
			var products = [];
			if (typeof window.productsData !== 'undefined') {
				products = window.productsData;
			} else {
				var stored = localStorage.getItem('adminProducts');
				if (stored) {
					try {
						products = JSON.parse(stored);
					} catch(e) {}
				}
			}
			
			// √úr√ºnleri benzersiz ≈üekilde saymak i√ßin Set kullan (aynƒ± √ºr√ºn√º iki kez saymamak i√ßin)
			var countedProductIndexes = new Set();
			var productCount = 0;
			var catTitleTr = cat.title ? (cat.title.tr || '') : '';
			var catTitleEn = cat.title ? (cat.title.en || '') : '';
			
			// √ñnce bu ana kategoriye ait alt kategorileri bul
			var subCategoryTitles = [];
			if (categoriesData.subCategories) {
				categoriesData.subCategories.forEach(function(sc) {
					if (sc.mainCategoryId === cat.id) {
						var subTitleTr = sc.title ? (sc.title.tr || '') : '';
						var subTitleEn = sc.title ? (sc.title.en || '') : '';
						if (subTitleTr || subTitleEn) {
							subCategoryTitles.push({
								tr: subTitleTr,
								en: subTitleEn
							});
						}
					}
				});
			}
			
			// √úr√ºnleri say - her √ºr√ºn√º sadece bir kez say
			products.forEach(function(product, productIndex) {
				var isCounted = false;
				
				// Ana kategori kontrol√º
				if (product.mainCategory) {
					var prodMainTr = product.mainCategory.tr || '';
					var prodMainEn = product.mainCategory.en || '';
					if ((catTitleTr && prodMainTr === catTitleTr) || (catTitleEn && prodMainEn === catTitleEn)) {
						if (!countedProductIndexes.has(productIndex)) {
							countedProductIndexes.add(productIndex);
							productCount++;
							isCounted = true;
						}
					}
				}
				
				// Alt kategori kontrol√º (eƒüer ana kategoride sayƒ±lmadƒ±ysa)
				if (!isCounted && product.category && subCategoryTitles.length > 0) {
					var prodCatTr = product.category.tr || '';
					var prodCatEn = product.category.en || '';
					
					subCategoryTitles.forEach(function(subTitle) {
						if (!countedProductIndexes.has(productIndex)) {
							if ((subTitle.tr && prodCatTr === subTitle.tr) || (subTitle.en && prodCatEn === subTitle.en)) {
								countedProductIndexes.add(productIndex);
								productCount++;
								isCounted = true;
							}
						}
					});
				}
			});
			
			var message = '"' + title + '" ana kategorisini silmek istediƒüinize emin misiniz?';
			if (productCount > 0) {
				message = '"' + title + '" ana kategorisini silmek istediƒüinize emin misiniz?\n\n';
				message += '‚ö†Ô∏è Bu kategoriye ait ' + productCount + ' √ºr√ºn bulunmaktadƒ±r.\n';
				message += 'Bu √ºr√ºnler kategorisiz olacaktƒ±r.';
			}
			
			showConfirm(message, 'Kategori Silme').then(function(confirmed) {
				if (!confirmed) return;
				var catId = cat.id;
			// Alt kategorileri de sil
			if (categoriesData.subCategories) {
				categoriesData.subCategories = categoriesData.subCategories.filter(function(sc) {
					return sc.mainCategoryId !== catId;
				});
			}
			categoriesData.mainCategories.splice(index, 1);
			// localStorage'a kaydetme - direkt backend'e kaydet
			renderCategories();
			
			// Backend'e kaydet (kategori sayfalarƒ±nƒ±n g√ºncellenmesi i√ßin)
			saveCategoriesToServer();
			});
		}
		
		function saveMainCategory() {
			var index = parseInt($('#mainCategoryIndex').val());
			var slug = $('#mainSlug').val().trim().toLowerCase().replace(/\s+/g, '-');
			
			if (!slug) {
				showAlert('warning', 'Slug gerekli!');
				return;
			}
			
			var category = {
				id: 'main_' + slug,
				title: {
					tr: $('#mainTitleTr').val(),
					en: $('#mainTitleEn').val(),
					ka: $('#mainTitleKa').val(),
					ru: $('#mainTitleRu').val()
				},
				description: {
					tr: $('#mainDescriptionTr').val(),
					en: $('#mainDescriptionEn').val(),
					ka: $('#mainDescriptionKa').val(),
					ru: $('#mainDescriptionRu').val()
				},
				slug: slug,
				headerImage: $('#mainCategoryImage').val().trim() || ''
			};
			
			if (!category.title.tr && !category.title.en && !category.title.ka && !category.title.ru) {
				showAlert('warning', 'L√ºtfen en az bir dilde kategori adƒ± girin!');
				return;
			}
			
			if (index === -1) {
				categoriesData.mainCategories.push(category);
			} else {
				var oldId = categoriesData.mainCategories[index].id;
				categoriesData.mainCategories[index] = category;
				// Alt kategorilerdeki referanslarƒ± g√ºncelle
				if (categoriesData.subCategories && oldId !== category.id) {
					categoriesData.subCategories.forEach(function(sc) {
						if (sc.mainCategoryId === oldId) {
							sc.mainCategoryId = category.id;
						}
					});
				}
			}
			
			// localStorage kullanƒ±mƒ± kaldƒ±rƒ±ldƒ± - backend'e kaydediliyor
			renderCategories();
			closeMainCategoryModal();
			
			// Backend'e kaydet
			saveCategoriesToServer();
		}
		
		// Alt kategori modal
		function openSubCategoryModal() {
			if (!categoriesData.mainCategories || categoriesData.mainCategories.length === 0) {
				return;
			}
			
			$('#subCategoryIndex').val('-1');
			$('#subCategoryModalTitle').text('Alt Kategori Ekle');
			$('#subCategoryForm')[0].reset();
			
			var $menu = $('#subMainCategoryMenu');
			var $trigger = $('#subMainCategoryTrigger');
			var $hiddenInput = $('#subMainCategoryId');
			
			$menu.empty();
			$menu.append('<button type="button" class="category-item" data-value="">Se√ßiniz...</button>');
			
			categoriesData.mainCategories.forEach(function(mc) {
				var title = mc.title ? (mc.title.tr || 'Kategori') : 'Kategori';
				$menu.append('<button type="button" class="category-item" data-value="' + escapeHtml(mc.id) + '">' + escapeHtml(title) + '</button>');
			});
			
			$hiddenInput.val('');
			$trigger.find('.category-dropdown-label').text('Se√ßiniz...');
			
			$('#subCategoryModal').css('display', 'flex');
			switchLangSub('tr');
		}
		
		function closeSubCategoryModal() {
			$('#subCategoryModal').hide();
		}
		
		function editSubCategory(index) {
			if (!categoriesData.subCategories || index < 0 || index >= categoriesData.subCategories.length) return;
			
			var subCat = categoriesData.subCategories[index];
			$('#subCategoryIndex').val(index);
			$('#subCategoryModalTitle').text('Alt Kategori D√ºzenle');
			
			var $menu = $('#subMainCategoryMenu');
			var $trigger = $('#subMainCategoryTrigger');
			var $hiddenInput = $('#subMainCategoryId');
			
			// Ana kategorileri dropdown'a y√ºkle
			$menu.empty();
			$menu.append('<button type="button" class="category-item" data-value="">Se√ßiniz...</button>');
			
			categoriesData.mainCategories.forEach(function(mc) {
				var title = mc.title ? (mc.title.tr || 'Kategori') : 'Kategori';
				$menu.append('<button type="button" class="category-item" data-value="' + escapeHtml(mc.id) + '">' + escapeHtml(title) + '</button>');
			});
			
			// Se√ßili kategoriyi i≈üaretle
			if (subCat.mainCategoryId) {
				$hiddenInput.val(subCat.mainCategoryId);
				var $selectedItem = $menu.find('.category-item[data-value="' + escapeHtml(subCat.mainCategoryId) + '"]');
				if ($selectedItem.length) {
					$menu.find('.category-item').removeClass('active');
					$selectedItem.addClass('active');
					$trigger.find('.category-dropdown-label').text($selectedItem.text());
				}
			} else {
				$hiddenInput.val('');
				$trigger.find('.category-dropdown-label').text('Se√ßiniz...');
			}
			
			$('#subTitleTr').val(subCat.title ? subCat.title.tr || '' : '');
			$('#subTitleEn').val(subCat.title ? subCat.title.en || '' : '');
			$('#subTitleKa').val(subCat.title ? subCat.title.ka || '' : '');
			$('#subTitleRu').val(subCat.title ? subCat.title.ru || '' : '');
			
			$('#subCategoryModal').css('display', 'flex');
			switchLangSub('tr');
		}
		
		function deleteSubCategory(index) {
			if (!categoriesData.subCategories || index < 0 || index >= categoriesData.subCategories.length) return;
			
			var subCat = categoriesData.subCategories[index];
			var title = subCat.title ? (subCat.title.tr || 'Alt Kategori') : 'Alt Kategori';
			
			// Bu alt kategoriye ait √ºr√ºn sayƒ±sƒ±nƒ± say
			var products = [];
			if (typeof window.productsData !== 'undefined') {
				products = window.productsData;
			} else {
				var stored = localStorage.getItem('adminProducts');
				if (stored) {
					try {
						products = JSON.parse(stored);
					} catch(e) {}
				}
			}
			
			var productCount = 0;
			var subTitleTr = subCat.title ? (subCat.title.tr || '') : '';
			var subTitleEn = subCat.title ? (subCat.title.en || '') : '';
			
			products.forEach(function(product) {
				if (product.category) {
					var prodCatTr = product.category.tr || '';
					var prodCatEn = product.category.en || '';
					if ((subTitleTr && prodCatTr === subTitleTr) || (subTitleEn && prodCatEn === subTitleEn)) {
						productCount++;
					}
				}
			});
			
			var message = '"' + title + '" alt kategorisini silmek istediƒüinize emin misiniz?';
			if (productCount > 0) {
				message = '"' + title + '" alt kategorisini silmek istediƒüinize emin misiniz?\n\n';
				message += '‚ö†Ô∏è Bu alt kategoriye ait ' + productCount + ' √ºr√ºn bulunmaktadƒ±r.\n';
				message += 'Bu √ºr√ºnler kategorisiz olacaktƒ±r.';
			}
			
			showConfirm(message, 'Alt Kategori Silme').then(function(confirmed) {
				if (!confirmed) return;
				
				categoriesData.subCategories.splice(index, 1);
				// localStorage'a kaydetme - direkt backend'e kaydet
				renderCategories();
				
				// Backend'e kaydet (kategori sayfalarƒ±nƒ±n g√ºncellenmesi i√ßin)
				saveCategoriesToServer();
			});
		}
		
		function saveSubCategory() {
			var index = parseInt($('#subCategoryIndex').val());
			var mainCategoryId = $('#subMainCategoryId').val();
			if (!mainCategoryId) {
				showAlert('warning', 'L√ºtfen bir ana kategori se√ßin!');
				return;
			}
			
			var titleTr = $('#subTitleTr').val().trim();
			var titleEn = $('#subTitleEn').val().trim();
			var titleKa = $('#subTitleKa').val().trim();
			var titleRu = $('#subTitleRu').val().trim();
			
			if (!titleTr && !titleEn && !titleKa && !titleRu) {
				showAlert('warning', 'L√ºtfen en az bir dilde kategori adƒ± girin!');
				return;
			}
			
			var subCategory = {
				id: index === -1 ? 'sub_' + Date.now() : categoriesData.subCategories[index].id,
				mainCategoryId: mainCategoryId,
				title: {
					tr: titleTr,
					en: titleEn,
					ka: titleKa,
					ru: titleRu
				}
			};
			
			if (!categoriesData.subCategories) {
				categoriesData.subCategories = [];
			}
			
			if (index === -1) {
				// Yeni alt kategori ekle
				categoriesData.subCategories.push(subCategory);
			} else {
				// Mevcut alt kategoriyi g√ºncelle
				categoriesData.subCategories[index] = subCategory;
			}
			
			// localStorage kullanƒ±mƒ± kaldƒ±rƒ±ldƒ± - backend'e kaydediliyor
			renderCategories();
			closeSubCategoryModal();
			
			// Backend'e kaydet
			saveCategoriesToServer();
		}
		
		// Dil deƒüi≈ütirme
		function switchLang(lang) {
			$('#mainCategoryModal .lang-tab').removeClass('active');
			$('#mainCategoryModal .lang-content').removeClass('active');
			$('#mainCategoryModal .lang-tab').each(function() {
				var btnLang = $(this).attr('onclick');
				if (btnLang && btnLang.indexOf("'" + lang + "'") !== -1) {
					$(this).addClass('active');
				}
			});
			$('#lang-' + lang).addClass('active');
		}
		
		function switchLangSub(lang) {
			$('#subCategoryModal .lang-tab').removeClass('active');
			$('#subCategoryModal .lang-content').removeClass('active');
			$('#subCategoryModal .lang-tab').each(function() {
				var btnLang = $(this).attr('onclick');
				if (btnLang && btnLang.indexOf("'" + lang + "'") !== -1) {
					$(this).addClass('active');
				}
			});
			$('#lang-sub-' + lang).addClass('active');
		}
		
		// Sunucuya kaydet
		function saveCategoriesToServer() {
			// √ñnce session kontrol√º yap
			$.ajax({
				url: '/api/admin/check-session',
				method: 'GET',
				success: function(sessionResponse) {
					if (!sessionResponse.authenticated) {
						showAlert('error', 'Oturum s√ºresi doldu. L√ºtfen tekrar giri≈ü yapƒ±n.');
						$('#pageContent').hide();
						$('#loginScreen').show();
						return;
					}
					
					// Session var, kaydetme i≈ülemini yap
					performSave();
				},
				error: function() {
					showAlert('error', 'Oturum kontrol√º yapƒ±lamadƒ±. L√ºtfen tekrar giri≈ü yapƒ±n.');
					$('#pageContent').hide();
					$('#loginScreen').show();
				}
			});
			
			function performSave() {
				// mainCategories formatƒ±nƒ± server'a uygun hale getir
				var mainCategories = categoriesData.mainCategories.map(function(mc) {
					var mainCat = {
						title: mc.title,
						slug: mc.slug,
						description: mc.description || { tr: '', en: '', ka: '', ru: '' },
						headerImage: mc.headerImage || '' // headerImage'ƒ± da ekle
					};
					
					// Alt kategorileri de ekle (sadece bu ana kategoriye ait olanlarƒ±)
					if (categoriesData.subCategories && categoriesData.subCategories.length > 0) {
						var subCats = categoriesData.subCategories.filter(function(sc) {
							return sc.mainCategoryId === mc.id;
						}).map(function(sc) {
							return {
								title: sc.title || { tr: '', en: '', ka: '' }
							};
						});
						
						// Alt kategorileri ekle (bo≈ü array bile olsa)
						mainCat.subCategories = subCats;
					} else {
						// Alt kategori yoksa bo≈ü array
						mainCat.subCategories = [];
					}
					
					return mainCat;
				});
				
				// Products data'yƒ± da g√∂nder (√ß√ºnk√º server aynƒ± endpoint'i kullanƒ±yor)
				var products = [];
				if (typeof window.productsData !== 'undefined') {
					products = window.productsData;
				} else {
					var stored = localStorage.getItem('adminProducts');
					if (stored) {
						try {
							products = JSON.parse(stored);
						} catch(e) {}
					}
				}
				
				// Carousel verilerini de al (varsa)
				var carousel = null;
				var carouselData = [];
				var autoCategoryExcluded = [];
				
				var carouselStored = localStorage.getItem('adminCarousel');
				if (carouselStored) {
					try {
						var parsed = JSON.parse(carouselStored);
						if (Array.isArray(parsed)) {
							carouselData = parsed;
						} else if (parsed && parsed.slides) {
							carouselData = parsed.slides;
						}
					} catch(e) {}
				}
				
				var excludedStored = localStorage.getItem('adminCarouselExcluded');
				if (excludedStored) {
					try {
						autoCategoryExcluded = JSON.parse(excludedStored);
					} catch(e) {}
				}
				
				if (carouselData.length > 0 || autoCategoryExcluded.length > 0) {
					carousel = {
						slides: carouselData,
						excludedAutoCategories: autoCategoryExcluded
					};
				}
				
				$.ajax({
					url: '/api/products/save',
					method: 'POST',
					contentType: 'application/json',
					data: JSON.stringify({
						products: products,
						mainCategories: mainCategories,
						carousel: carousel
					}),
					success: function(response) {
						// Backend'e kaydedildi, localStorage'a da kaydet (fallback i√ßin)
						// localStorage kullanƒ±mƒ± kaldƒ±rƒ±ldƒ± - backend'e kaydediliyor
						showAlert('success', 'Kategoriler ba≈üarƒ±yla kaydedildi!');
					},
					error: function(xhr) {
						if (xhr.status === 401) {
							showAlert('error', 'Oturum s√ºresi doldu. L√ºtfen tekrar giri≈ü yapƒ±n.');
							$('#pageContent').hide();
							$('#loginScreen').show();
						} else {
							showAlert('error', 'Kategoriler backend\'e kaydedilemedi! L√ºtfen tekrar deneyin.');
						}
					}
				});
			}
		}
		
		// Global fonksiyonlar
		// Ana kategori g√∂rsel y√ºkle
		function uploadMainCategoryImage() {
			var fileInput = document.getElementById('mainCategoryImageFile');
			if (!fileInput || !fileInput.files || !fileInput.files[0]) return;
			
			var file = fileInput.files[0];
			var formData = new FormData();
			formData.append('image', file);
			
			// √ñnce session kontrol√º yap
			$.ajax({
				url: '/api/admin/check-session',
				method: 'GET',
				success: function(sessionResponse) {
					if (!sessionResponse.authenticated) {
						showAlert('error', 'Oturum s√ºresi doldu. L√ºtfen tekrar giri≈ü yapƒ±n.');
						$('#pageContent').hide();
						$('#loginScreen').show();
						return;
					}
					
					// Session var, y√ºkleme i≈ülemini yap
					performUpload();
				},
				error: function() {
					showAlert('error', 'Oturum kontrol√º yapƒ±lamadƒ±. L√ºtfen tekrar giri≈ü yapƒ±n.');
					$('#pageContent').hide();
					$('#loginScreen').show();
				}
			});
			
			function performUpload() {
				// Y√ºkleme ba≈üladƒ± g√∂ster
				var btn = document.getElementById('uploadMainCategoryBtn');
				if (!btn) {
					btn = fileInput.nextElementSibling;
				}
				var isMobile = window.innerWidth <= 768;
				var defaultText = isMobile ? 'üìÅ Telefondan Y√ºkle' : 'üìÅ Bilgisayardan Y√ºkle';
				var originalText = btn ? (btn.innerHTML || defaultText) : defaultText;
				if (btn) {
					btn.innerHTML = '‚è≥ Y√ºkleniyor...';
					btn.disabled = true;
				}
				
				$.ajax({
					url: '/api/upload-image',
					method: 'POST',
					data: formData,
					processData: false,
					contentType: false,
					success: function(response) {
						if (response && response.success && response.url) {
							var imageUrl = response.url;
							$('#mainCategoryImage').val(imageUrl);
							
							// Preview'ƒ± g√ºncelle
							var $previewImg = $('#mainCategoryImagePreviewImg');
							var $preview = $('#mainCategoryImagePreview');
							
							$previewImg.attr('src', imageUrl).off('error load').on('error', function() {
								console.error('Resim y√ºklenemedi:', imageUrl);
								$preview.hide();
							}).on('load', function() {
								$preview.show();
							});
							
							// Eƒüer resim zaten y√ºklenmi≈üse (cache'den) direkt g√∂ster
							if ($previewImg[0].complete && $previewImg[0].naturalWidth > 0) {
								$preview.show();
							}
							
							if (btn) {
								btn.innerHTML = originalText;
								btn.disabled = false;
							}
							fileInput.value = ''; // Reset file input
						} else {
							showAlert('error', 'Resim y√ºkleme ba≈üarƒ±sƒ±z!');
							if (btn) {
								btn.innerHTML = originalText;
								btn.disabled = false;
							}
						}
					},
					error: function(xhr) {
						if (xhr.status === 401) {
							showAlert('error', 'Oturum s√ºresi doldu. L√ºtfen tekrar giri≈ü yapƒ±n.');
							$('#pageContent').hide();
							$('#loginScreen').show();
						} else {
							showAlert('error', 'Resim y√ºklenirken hata olu≈ütu!');
						}
						if (btn) {
							btn.innerHTML = originalText;
							btn.disabled = false;
						}
					}
				});
			}
		}
		
		// URL'den ana kategori g√∂rseli ekle
		function addMainCategoryImageUrl() {
			var url = $('#mainCategoryImage').val().trim();
			if (!url) return;
			
			// URL ge√ßerli mi kontrol et
			if (url.startsWith('http://') || url.startsWith('https://') || url.startsWith('/')) {
				var $previewImg = $('#mainCategoryImagePreviewImg');
				var $preview = $('#mainCategoryImagePreview');
				
				// √ñnceki event listener'larƒ± temizle
				$previewImg.off('error load');
				
				$previewImg.attr('src', url).on('error', function() {
					$preview.hide();
					showAlert('error', 'Resim y√ºklenemedi! URL\'yi kontrol edin.');
				}).on('load', function() {
					$preview.show();
				});
				
				// Eƒüer resim zaten y√ºklenmi≈üse (cache'den) direkt g√∂ster
				if ($previewImg[0].complete && $previewImg[0].naturalWidth > 0) {
					$preview.show();
				} else {
					$preview.show(); // √ñnce g√∂ster, y√ºklenemezse error handler gizleyecek
				}
			} else {
				showAlert('warning', 'Ge√ßerli bir URL girin! (http://, https:// veya / ile ba≈ülamalƒ±)');
			}
		}
		
		// Enter tu≈üuna basƒ±ldƒ±ƒüƒ±nda URL ekle
		$(document).on('keypress', '#mainCategoryImage', function(e) {
			if (e.which === 13) { // Enter tu≈üu
				e.preventDefault();
				addMainCategoryImageUrl();
			}
		});
		
		window.openMainCategoryModal = openMainCategoryModal;
		window.closeMainCategoryModal = closeMainCategoryModal;
		window.uploadMainCategoryImage = uploadMainCategoryImage;
		window.addMainCategoryImageUrl = addMainCategoryImageUrl;
		window.editMainCategory = editMainCategory;
		window.deleteMainCategory = deleteMainCategory;
		window.saveMainCategory = saveMainCategory;
		window.openSubCategoryModal = openSubCategoryModal;
		window.closeSubCategoryModal = closeSubCategoryModal;
		window.editSubCategory = editSubCategory;
		window.deleteSubCategory = deleteSubCategory;
		window.saveSubCategory = saveSubCategory;
		window.saveCategoriesToServer = saveCategoriesToServer;
		window.switchLang = switchLang;
		window.switchLangSub = switchLangSub;
		window.closePopup = closePopup;
		
		// Category dropdown event handlers
		$(document).on('click', '.category-dropdown-trigger', function(e) {
			e.stopPropagation();
			var $menu = $(this).siblings('.category-dropdown-menu');
			var isOpen = $menu.hasClass('open');
			$('.category-dropdown-menu').removeClass('open open-up');
			if (!isOpen) {
				$menu.addClass('open');
				
				// Ekranƒ±n altƒ±nda kalƒ±p kalmadƒ±ƒüƒ±nƒ± kontrol et
				setTimeout(function() {
					var menuRect = $menu[0].getBoundingClientRect();
					var viewportHeight = window.innerHeight || document.documentElement.clientHeight;
					var spaceBelow = viewportHeight - menuRect.bottom;
					var spaceAbove = menuRect.top;
					
					// Eƒüer a≈üaƒüƒ±da yeterli alan yoksa ve yukarƒ±da daha fazla alan varsa, yukarƒ± doƒüru a√ß
					if (spaceBelow < 50 && spaceAbove > spaceBelow) {
						$menu.addClass('open-up');
					} else {
						$menu.removeClass('open-up');
					}
				}, 10);
			}
		});
		
		$(document).on('click', function(e) {
			if (!$(e.target).closest('.category-dropdown').length) {
				$('.category-dropdown-menu').removeClass('open open-up');
			}
		});
		
		// Category item se√ßimi
		$(document).on('click', '.category-dropdown-menu .category-item', function(e) {
			e.stopPropagation();
			var $item = $(this);
			if ($item.prop('disabled')) return;
			var value = $item.data('value');
			var $dropdown = $item.closest('.category-dropdown');
			var $trigger = $dropdown.find('.category-dropdown-trigger');
			var $hiddenInput = $dropdown.find('input[type="hidden"]');
			var $menu = $dropdown.find('.category-dropdown-menu');
			
			// T√ºm item'lardan active class'ƒ±nƒ± kaldƒ±r
			$menu.find('.category-item').removeClass('active');
			
			// Se√ßili item'a active class'ƒ± ekle
			$item.addClass('active');
			
			// Hidden input'a deƒüeri yaz
			$hiddenInput.val(value || '');
			
			// Trigger label'ƒ±nƒ± g√ºncelle
			$trigger.find('.category-dropdown-label').text($item.text());
			
			// Menu'yu kapat
			$menu.removeClass('open open-up');
		});
		
		// HTML escape
		function escapeHtml(text) {
			if (!text) return '';
			var map = {
				'&': '&amp;',
				'<': '&lt;',
				'>': '&gt;',
				'"': '&quot;',
				"'": '&#039;'
			};
			return text.toString().replace(/[&<>"']/g, function(m) { return map[m]; });
		}
		
		// Sayfa y√ºklendiƒüinde - ≈üifre kontrol√ºnden sonra √ßalƒ±≈üacak
		function initCategoriesPage() {
			loadCategories();
		}
	</script>
	
	<script>
		// BACKEND SESSION KULLANIYOR - localStorage/sessionStorage yok
		var MAX_LOGIN_ATTEMPTS = 5;
		var LOGIN_ATTEMPTS_KEY = 'adminLoginAttempts';
		var LOCKOUT_TIME_KEY = 'adminLockoutUntil';
		var LOCKOUT_DURATION = 15 * 60 * 1000;

		function checkLogin() {
			checkLockout();
			
			// Backend'e session kontrol√º i√ßin istek at
			$.ajax({
				url: '/api/admin/check-session',
				method: 'GET',
				success: function(response) {
					if (response.authenticated) {
						// Session var - i√ßeriƒüi g√∂ster
						$('#loginScreen').hide();
						$('#pageContent').show();
						if (typeof initCategoriesPage === 'function') {
							initCategoriesPage();
						}
					} else {
						// Session yok veya s√ºresi dolmu≈ü
						if (response.expired) {
							showAlert('warning', 'Oturum s√ºresi doldu. L√ºtfen tekrar giri≈ü yapƒ±n.');
						}
						$('#loginScreen').show();
						$('#pageContent').hide();
					}
				},
				error: function() {
					// Hata durumunda login ekranƒ±nƒ± g√∂ster
					$('#loginScreen').show();
					$('#pageContent').hide();
				}
			});
		}

		function checkLockout() {
			var lockoutUntil = localStorage.getItem(LOCKOUT_TIME_KEY);
			if (lockoutUntil) {
				var now = Date.now();
				var unlockTime = parseInt(lockoutUntil);
				
				if (now < unlockTime) {
					var remainingMinutes = Math.ceil((unlockTime - now) / (60 * 1000));
					$('#loginError').html('‚õî √áok fazla yanlƒ±≈ü deneme!<br>L√ºtfen ' + remainingMinutes + ' dakika sonra tekrar deneyin.').fadeIn(300);
					$('#adminPassword').prop('disabled', true);
					$('button[onclick="checkPassword()"]').prop('disabled', true);
					return true;
				} else {
					localStorage.removeItem(LOCKOUT_TIME_KEY);
					localStorage.removeItem(LOGIN_ATTEMPTS_KEY);
					$('#adminPassword').prop('disabled', false);
					$('button[onclick="checkPassword()"]').prop('disabled', false);
				}
			}
			return false;
		}
		
		function checkPassword() {
			if (checkLockout()) return;
			
			var password = $('#adminPassword').val();
			
			if (!password) {
				$('#loginError').text('‚ö†Ô∏è ≈ûifre gerekli!').fadeIn(300);
				return;
			}
			
			$.ajax({
				url: '/api/admin/check-password',
				method: 'POST',
				contentType: 'application/json',
				data: JSON.stringify({ password: password }),
				success: function(response) {
					if (response.success) {
						localStorage.removeItem(LOGIN_ATTEMPTS_KEY);
						localStorage.removeItem(LOCKOUT_TIME_KEY);
						
					// Backend session olu≈üturuldu - frontend'de bir ≈üey yapmaya gerek yok
					
					// Overlay'i gizle
					$('#pageTransition').removeClass('show').addClass('hide');
					
					$('#loginScreen').fadeOut(300);
					$('#pageContent').fadeIn(300);
					$('#loginError').hide();
					$('#adminPassword').val('');
					$('#adminPassword').prop('disabled', false);
					$('button[onclick="checkPassword()"]').prop('disabled', false);
					initCategoriesPage();
					}
				},
				error: function(xhr) {
					var attempts = parseInt(localStorage.getItem(LOGIN_ATTEMPTS_KEY) || '0');
					attempts++;
					localStorage.setItem(LOGIN_ATTEMPTS_KEY, attempts.toString());
					
					var remainingAttempts = MAX_LOGIN_ATTEMPTS - attempts;
					
					if (attempts >= MAX_LOGIN_ATTEMPTS) {
						var lockoutUntil = Date.now() + LOCKOUT_DURATION;
						localStorage.setItem(LOCKOUT_TIME_KEY, lockoutUntil.toString());
						
						$('#loginError').html('‚õî √áok fazla yanlƒ±≈ü deneme!<br>Hesap 15 dakika s√ºreyle kilitlendi.').fadeIn(300);
						$('#adminPassword').prop('disabled', true);
						$('button[onclick="checkPassword()"]').prop('disabled', true);
						
						setTimeout(function() {
							localStorage.removeItem(LOCKOUT_TIME_KEY);
							localStorage.removeItem(LOGIN_ATTEMPTS_KEY);
							$('#loginError').hide();
							$('#adminPassword').prop('disabled', false);
							$('button[onclick="checkPassword()"]').prop('disabled', false);
							$('#adminPassword').val('').focus();
						}, LOCKOUT_DURATION);
					} else {
						var errorMsg = '‚ùå Yanlƒ±≈ü ≈üifre!';
						if (xhr.responseJSON && xhr.responseJSON.error) {
							errorMsg = '‚ùå ' + xhr.responseJSON.error;
						}
						errorMsg += '<br>Kalan deneme hakkƒ±: ' + remainingAttempts;
						$('#loginError').html(errorMsg).fadeIn(300);
					}
					
					$('#adminPassword').val('').focus();
				}
			});
		}

		$(document).on('keypress', '#adminPassword', function(e) {
			if (e.which === 13) {
				checkPassword();
			}
		});
		
		// Lockout kontrol√º (her 60 saniyede bir)
		setInterval(function() {
			var lockoutUntil = localStorage.getItem(LOCKOUT_TIME_KEY);
			if (lockoutUntil) {
				var now = Date.now();
				var unlockTime = parseInt(lockoutUntil);
				
				if (now < unlockTime) {
					var remainingMinutes = Math.ceil((unlockTime - now) / (60 * 1000));
					$('#loginError').html('‚õî √áok fazla yanlƒ±≈ü deneme!<br>L√ºtfen ' + remainingMinutes + ' dakika sonra tekrar deneyin.');
				} else {
					localStorage.removeItem(LOCKOUT_TIME_KEY);
					localStorage.removeItem(LOGIN_ATTEMPTS_KEY);
					$('#loginError').hide();
					$('#adminPassword').prop('disabled', false);
					$('button[onclick="checkPassword()"]').prop('disabled', false);
				}
			}
			
			// Backend session kontrol√º checkLogin() i√ßinde yapƒ±lƒ±yor
			// Eski sessionStorage kodlarƒ± kaldƒ±rƒ±ldƒ±
		}, 60000);

		// Buton metnini ekran boyutuna g√∂re g√ºncelle
		function updateUploadButtonText() {
			var isMobile = window.innerWidth <= 768;
			var buttonText = isMobile ? 'üìÅ Telefondan Y√ºkle' : 'üìÅ Bilgisayardan Y√ºkle';
			
			$('#uploadMainCategoryBtn').text(buttonText);
		}

		$(document).ready(function() {
			checkLogin();
			
			// Buton metnini g√ºncelle
			updateUploadButtonText();
			$(window).on('resize', updateUploadButtonText);
			
			// Backend session kontrol√º zaten checkLogin() i√ßinde yapƒ±lƒ±yor
			// Burada sadece overlay'i ayarla
			$('#pageTransition').removeClass('show').addClass('hide');
			
			// Admin Paneli linkine animasyonlu ge√ßi≈ü ekle
			$('a[href="admin.html"]').on('click', function(e) {
				e.preventDefault();
				$('#pageTransition').removeClass('hide').addClass('show');
				setTimeout(function() {
					window.location.href = 'admin.html';
				}, 300);
			});
		});
	</script>
	
	<!-- Ge√ßi≈ü Overlay -->
	<div class="page-transition-overlay" id="pageTransition">
		<div class="spinner"></div>
	</div>
	</div>
</body>
</html>

